import unittest
from unittest.mock import patch

from ragent.connectors.llm.stt.factory import STTFactory  # Assuming this is your module
from ragent.connectors.llm.stt.providers import STTProviders


class TestSTTFactory(unittest.TestCase):
    @patch("ragent.connectors.llm.stt.factory.OpenAISpeechToText")
    def test_get_openai_provider(self, mock_openai_class):
        # Arrange: Setup mock return
        mock_instance = mock_openai_class.return_value

        # Act: Call the factory
        result = STTFactory.get_stt_provider(STTProviders.OPENAI)

        # Assert: Make sure it's returning the mock instance
        self.assertEqual(result, mock_instance)
        mock_openai_class.assert_called_once()

    def test_invalid_provider_raises(self):
        # Act & Assert
        with self.assertRaises(ValueError):
            STTFactory.get_stt_provider("INVALID_PROVIDER")


if __name__ == "__main__":
    unittest.main()
