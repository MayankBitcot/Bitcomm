from abc import ABC, abstractmethod

from ragent.connectors.email_sender.utils import is_valid_email
from ragent.log_utils import logger


class EmailSender(ABC):
    def send_email(self, from_email: str, to_email: str, email_body: str, subject: str):
        logger.info(f"Attempting to send email from {from_email} to {to_email}")
        if not is_valid_email(to_email):
            logger.error(f"Invalid email address: {to_email}")
            raise ValueError(f"Invalid email address: {to_email}")
        if not email_body:
            logger.error("Email body is empty")
            raise ValueError("Email body is empty")
        return self._send(
            from_email,
            to_email,
            email_body,
            subject,
        )

    @abstractmethod
    def _send(self, from_email: str, to_email: str, email_body: str, subject: str):
        pass
