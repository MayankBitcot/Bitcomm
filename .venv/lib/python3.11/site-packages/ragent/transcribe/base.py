"""Base transcriber interface for all transcription providers."""

from abc import ABC, abstractmethod
from pathlib import Path
from typing import Any, BinaryIO, Dict, Optional, Union


class TranscriberError(Exception):
    """Base exception for transcriber errors."""

    pass


class BaseTranscriber(ABC):
    """
    Abstract base class for all transcription providers.

    All transcriber implementations should inherit from this class
    and implement the transcribe method.
    """

    @abstractmethod
    def transcribe(
        self,
        audio_input: Union[str, Path, bytes, BinaryIO],
        filename: Optional[str] = None,
        content_type: Optional[str] = None,
        prompt: Optional[str] = None,
        language: Optional[str] = None,
        response_format: str = "verbose_json",
        temperature: Optional[float] = None,
    ) -> Dict[str, Any]:
        """
        Transcribe audio file synchronously.

        Args:
            audio_input: Audio file path, Path object, bytes, or file-like object
            filename: Optional filename for extension detection
            content_type: Optional MIME type for extension detection
            prompt: Optional prompt to guide transcription style or vocabulary
            language: Optional language code (ISO-639-1). If None, auto-detects.
            response_format: Response format ("json", "text", "srt", "verbose_json", "vtt")
            temperature: Sampling temperature (0.0 to 1.0). Higher = more random.

        Returns:
            Dictionary with keys:
                - transcript: Transcribed text
                - language: Detected language code
                - duration: Audio duration in seconds (if available)
                - words: Word-level timestamps (if verbose_json)

        Raises:
            TranscriberError: For transcription errors
        """
        pass

    @abstractmethod
    async def transcribe_async(
        self,
        audio_input: Union[str, Path, bytes, BinaryIO],
        filename: Optional[str] = None,
        content_type: Optional[str] = None,
        prompt: Optional[str] = None,
        language: Optional[str] = None,
        response_format: str = "verbose_json",
        temperature: Optional[float] = None,
    ) -> Dict[str, Any]:
        """
        Transcribe audio file asynchronously.

        Same parameters and return value as transcribe(), but async.
        """
        pass
