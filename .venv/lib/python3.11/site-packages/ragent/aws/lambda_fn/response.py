from typing import Dict, Tuple, Union

from ragent.log_utils import logger


def create_response(
    success: bool,
    message: Union[str, dict],
    status_code: int,
) -> Tuple[Dict, int]:
    """
    Create a standardized API response.

    Args:
        success (bool): Whether the operation was successful.
        message (Union[str, dict]): Response message or data.
        status_code (int): HTTP status code.

    Returns:
        Tuple[Dict, int]: A tuple containing (response_data, status_code)
                          for compatibility with call_fn.
    """
    # Initialize response content
    response_content = {"status": success, "message": "", "data": {}}

    # Handle message based on type
    if isinstance(message, dict):
        if "message" in message:
            response_content["message"] = message.pop("message")
        response_content["data"] = message
    else:
        response_content["message"] = str(message)

    logger.info(f"Response content: {response_content}")

    # Return a tuple of (data, status_code) as expected by call_fn
    return response_content, status_code
